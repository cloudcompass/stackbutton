<div layout="column" flex>
  <!-- Top bar begin -->
  <md-toolbar layout="row" layout-align="space-between stretch">
    <div layout="row" layout-align="start center" class="capitalize logo-box" hide-xs>
      <img ui-sref="home.projects" class="sb-logo detail sb-48px">
      <h1> StackButton</h1>
    </div>

    <md-button hide show-xs ng-click="vm.toggleItemsList()" aria-label="Menu">
      <i class="material-icons">menu</i>
    </md-button>

    <div layout="row" layout-align="start center">
      <md-menu>
        <md-button ng-click="$mdOpenMenu()" aria-label="Open menu" class="toolbar-button">
          <span class="orig-case" hide-xs>{{ currentUser==null ? 'unknown' : currentUser.username }}</span>
          <i class="material-icons">account_circle</i>
        </md-button>
        <md-menu-content width="3">
          <md-menu-item>
            <md-button ng-click="$mdCloseMenu()" ui-sref="home.profile">Profile</md-button>
          </md-menu-item>
          <md-menu-item>
            <md-button ng-click="vm.logOut()">Log out</md-button>
          </md-menu-item>
        </md-menu-content>
      </md-menu>

      <md-button class="toolbar-button" ng-click="vm.toggleRightSidebar()" aria-label="Open activity feed">
        <i class="material-icons">{{vm.showActivities==true ? 'keyboard_arrow_right' : 'keyboard_arrow_down'}}</i>
      </md-button>
    </div>
  </md-toolbar>

  <!-- Top bar end -->

  <div layout="row" flex>
    <!-- Left nav begin -->
    <md-sidenav md-is-locked-open="$mdMedia('gt-xs')" md-component-id="left" show hide="vm.title=='Projects'"
                class="md-whiteframe-z2 md-sidenav-left" md-theme="dark">

      <span layout-margin ui-sref="home.projects">
          Project:
        </span>
      <div layout="column" layout-align="start start">

        <md-select placeholder="Select a Project" ng-model="currentProject" md-on-open="vm.loadProjects()"
                   style="min-width:100%;margin:0 0 2em 0">
          <md-option ng-repeat="project in vm.projectList" ng-value="project" ng-click="vm.selectProject(project)">
            {{project.name}}
          </md-option>
        </md-select>
      </div>

      <!-- Menu items -->
      <div ng-hide="currentProject==null">
        <div ng-repeat-start="item in vm.menuItems[0].server" layout="column" layout-align="start stretch">
          <md-button layout="row" layout-align="space-between center" class="capitalize"
                     ng-click="item.expanded=!item.expanded" ng-click="vm.selectItem(item)"
                     ui-sref="{{item.sref}}">
       <span>
         <i hide-sm class="material-icons md-24">{{item.icon}}</i>
         {{item.name}}
       </span>
       <span>
         <i class="material-icons md-24" ng-show="item.expanded&&item.children">expand_less</i>
         <i class="material-icons md-24" ng-hide="item.expanded||!item.children">expand_more</i>
       </span>

          </md-button>

          <div layout="column" layout-align="start stretch"
               ui-sref-active="md-warn"
               ng-show="item.expanded">
            <md-button ng-repeat="child in item.children" ui-sref="{{child.sref}}"
                       class="capitalize" ng-click="vm.toggleItemsList()"
                       flex-offset="20" layout="row" layout-align="start center">
              {{child.name}}
            </md-button>
          </div>
        </div>
        <md-divider ng-repeat-end></md-divider>
      </div>
      <!-- end Menu items -->
    </md-sidenav>
    <!-- Left nav end -->

    <!-- Content begin -->
    <md-content flex class="md-padding page-content">
      <div ui-view></div>
    </md-content>
    <!-- Content end -->


    <!-- Right pop-out begin-->
    <md-sidenav md-component-id="right" md-is-locked-open="vm.showActivities==true"
                class="md-whiteframe-z2 md-sidenav-right">
      <div ng-include="'app/views/partials/activities.html'"/>
    </md-sidenav>
    <!-- Right pop-out end -->
  </div>
</div>
